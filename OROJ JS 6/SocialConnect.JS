 // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ±Ø¬Ù…Ø©
const translations = {
    ar: {
        postPlaceholder: "Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªÙÙƒØ± ÙÙŠÙ‡ ÙŠØ§ Ù…Ø­Ù…Ø¯ØŸ",
        searchPlaceholder: "Ø§Ù„Ø¨Ø­Ø« ÙÙŠ SocialConnect",
        chatPlaceholder: "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..."
    },
    en: {
        postPlaceholder: "What's on your mind, Mohamed?",
        searchPlaceholder: "Search SocialConnect",
        chatPlaceholder: "Type a message..."
    },
    fr: {
        postPlaceholder: "Ã€ quoi pensez-vous, Michel?",
        searchPlaceholder: "Rechercher SocialConnect",
        chatPlaceholder: "Tapez un message..."
    }
};

let currentLanguage = 'fr';
let currentChat = null;

// ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©
function changeLanguage(lang) {
    currentLanguage = lang;
    const t = translations[lang];
    
    document.getElementById('postInput').placeholder = t.postPlaceholder;
    document.getElementById('searchBox').placeholder = t.searchPlaceholder;
    document.getElementById('chatInput').placeholder = t.chatPlaceholder;
    
    // ØªØºÙŠÙŠØ± Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù†Øµ
    if (lang === 'ar') {
        document.documentElement.setAttribute('dir', 'rtl');
        document.documentElement.setAttribute('lang', 'ar');
    } else {
        document.documentElement.setAttribute('dir', 'ltr');
        document.documentElement.setAttribute('lang', lang);
    }
}

// ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
function openMessenger(contactName = 'Chat') {
    currentChat = contactName;
    document.getElementById('messengerPopup').style.display = 'flex';
    document.getElementById('messengerTitle').textContent = contactName;
}

// Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
function closeMessenger() {
    document.getElementById('messengerPopup').style.display = 'none';
}

// Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
function sendMessage() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    if (!message) return;
    
    const chatMessages = document.getElementById('chatMessages');
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø±Ø³Ù„Ø©
    const sentMessage = document.createElement('div');
    sentMessage.className = 'message sent fade-in';
    sentMessage.innerHTML = `<div class="message-bubble">${message}</div>`;
    chatMessages.appendChild(sentMessage);
    
    input.value = '';
    chatMessages.scrollTop = chatMessages.scrollHeight;
    
    // Ø±Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ
    setTimeout(() => {
        const replies = [
            'Merci pour votre message !',
            'D\'accord, je vous recontacterai bientÃ´t',
            'Excellente idÃ©e !',
            'Message reÃ§u, merci',
            'Je vais examiner cela et vous rÃ©pondre'
        ];
        const randomReply = replies[Math.floor(Math.random() * replies.length)];
        
        const receivedMessage = document.createElement('div');
        receivedMessage.className = 'message received fade-in';
        receivedMessage.innerHTML = `<div class="message-bubble">${randomReply}</div>`;
        chatMessages.appendChild(receivedMessage);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }, 1000);
}

// ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨
function toggleLike(button) {
    button.classList.toggle('liked');
    const span = button.querySelector('span');
    if (button.classList.contains('liked')) {
        span.textContent = 'â¤ï¸';
    } else {
        span.textContent = 'ğŸ‘';
    }
}

// Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ± Ø¬Ø¯ÙŠØ¯
function createPost() {
    const input = document.getElementById('postInput');
    const content = input.value.trim();
    if (!content) return;
    
    const centerContent = document.querySelector('.center-content');
    const postCreator = document.querySelector('.post-creator');
    
    const newPost = document.createElement('div');
    newPost.className = 'post fade-in';
    newPost.innerHTML = `
        <div class="post-header">
            <div class="post-avatar">M</div>
            <div class="post-info">
                <div class="post-author">Michel Dubois</div>
                <div class="post-time">Maintenant Â· ğŸŒ</div>
            </div>
            <div style="margin-left: auto; cursor: pointer; padding: 8px; border-radius: 50%; color: #65676b;">â‹¯</div>
        </div>
        <div class="post-content">${content}</div>
        <div class="post-actions-bar">
            <button class="post-action-btn" onclick="toggleLike(this)">
                <span>ğŸ‘</span> J'aime
            </button>
            <button class="post-action-btn" onclick="openMessenger()">
                <span>ğŸ’¬</span> Commenter
            </button>
            <button class="post-action-btn">
                <span>ğŸ“¤</span> Partager
            </button>
        </div>
    `;
    
    centerContent.insertBefore(newPost, postCreator.nextSibling);
    input.value = '';
}

// Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
document.addEventListener('DOMContentLoaded', function() {
    // ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©
    document.getElementById('languageSelector').addEventListener('change', (e) => {
        changeLanguage(e.target.value);
    });

    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
    document.getElementById('chatInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
    });

    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ± Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
    document.getElementById('postInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') createPost();
    });

    // ØªØ­Ø³ÙŠÙ† Ù…Ø¸Ù‡Ø± Ø­Ù‚Ù„ Ø§Ù„Ù†Ø´Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ±ÙƒÙŠØ²
    document.getElementById('postInput').addEventListener('click', () => {
        const input = document.getElementById('postInput');
        input.style.background = 'rgba(255, 255, 255, 0.25)';
        input.style.borderColor = 'rgba(255, 255, 255, 0.5)';
    });

    // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
    document.addEventListener('click', (e) => {
        const popup = document.getElementById('messengerPopup');
        if (!popup.contains(e.target) && 
            !e.target.closest('.contact-item') && 
            !e.target.closest('.post-action-btn')) {
            if (popup.style.display === 'flex') {
                closeMessenger();
            }
        }
    });
});